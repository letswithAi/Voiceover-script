<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Saving Maker - Smart Financial Planning</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --warning-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --danger-gradient: linear-gradient(135deg, #ff6b6b 0%, #ffa500 100%);
        }

        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        .hero-section {
            background: var(--primary-gradient);
            color: white;
            padding: 3rem 0;
            border-radius: 0 0 50px 50px;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .card {
            border: none;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .input-card {
            background: white;
            backdrop-filter: blur(10px);
        }

        .form-control {
            border-radius: 15px;
            border: 2px solid #e9ecef;
            padding: 12px 20px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: #667eea;
            box-shadow: 0 0 20px rgba(102, 126, 234, 0.1);
        }

        .btn-ai {
            background: var(--primary-gradient);
            border: none;
            border-radius: 25px;
            padding: 12px 30px;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-ai:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
            color: white;
        }

        .advice-card {
            border-left: 5px solid;
            transition: all 0.3s ease;
        }

        .advice-card.success {
            border-left-color: #28a745;
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
        }

        .advice-card.warning {
            border-left-color: #ffc107;
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
        }

        .advice-card.danger {
            border-left-color: #dc3545;
            background: linear-gradient(135deg, #f8d7da 0%, #f5c6cb 100%);
        }

        .chart-container {
            position: relative;
            height: 400px;
            background: white;
            border-radius: 20px;
            padding: 20px;
        }

        .stat-card {
            text-align: center;
            padding: 1.5rem;
            border-radius: 15px;
            color: white;
            margin-bottom: 1rem;
        }

        .stat-card.income {
            background: var(--success-gradient);
        }

        .stat-card.expenses {
            background: var(--warning-gradient);
        }

        .stat-card.savings {
            background: var(--primary-gradient);
        }

        .loading-spinner {
            display: none;
        }

        .ai-suggestion {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .floating-icon {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--primary-gradient);
            color: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        .results-section {
            display: none;
        }

        .currency-display {
            font-size: 0.9rem;
            color: #667eea;
            font-weight: bold;
        }

        @media (max-width: 768px) {
            .hero-section {
                padding: 2rem 0;
            }

            .chart-container {
                height: 300px;
            }
        }
    </style>
</head>

<body>
    <!-- Hero Section -->
    <div class="hero-section">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-lg-8">
                    <h1 class="display-4 fw-bold mb-3">
                        <i class="fas fa-robot me-3"></i>AI Saving Maker
                    </h1>
                    <p class="lead mb-0">Financial freedom starts with smart AI for smart minds</p>
                </div>
                <div class="col-lg-4 text-end">
                    <i class="fas fa-chart-pie fa-5x opacity-50"></i>
                </div>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Input Section -->
        <div class="row mb-4">
            <div class="col-lg-8 mx-auto">
                <div class="card input-card position-relative">
                    <div class="floating-icon">
                        <i class="fas fa-calculator"></i>
                    </div>
                    <div class="card-body p-4">
                        <h3 class="card-title text-center mb-4">
                            <i class="fas fa-wallet me-2 text-primary"></i>
                            Enter Your Financial Details
                        </h3>

                        <form id="budgetForm">
                            <div class="row">
                                <div class="col-md-12 mb-3">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-globe text-info me-2"></i>
                                        Select Your Currency
                                    </label>
                                    <select class="form-control" id="currency" required>
                                        <option value="">Choose your country's currency...</option>
                                        <option value="USD" data-symbol="$" data-country="United States"
                                            data-flag="üá∫üá∏"> USD - US Dollar ($)</option>
                                        <option value="EUR" data-symbol="‚Ç¨" data-country="European Union"
                                            data-flag="üá™üá∫"> EUR - Euro (‚Ç¨)</option>
                                        <option value="GBP" data-symbol="¬£" data-country="United Kingdom"
                                            data-flag="üá¨üáß"> GBP - British Pound (¬£)</option>
                                        <option value="JPY" data-symbol="¬•" data-country="Japan" data-flag="üáØüáµ">
                                            JPY - Japanese Yen (¬•)</option>
                                        <option value="AUD" data-symbol="A$" data-country="Australia" data-flag="üá¶üá∫">
                                            AUD - Australian Dollar (A$)</option>
                                        <option value="CAD" data-symbol="C$" data-country="Canada" data-flag="üá®üá¶">
                                            CAD - Canadian Dollar (C$)</option>
                                        <option value="CHF" data-symbol="CHF" data-country="Switzerland"
                                            data-flag="üá®üá≠"> CHF - Swiss Franc (CHF)</option>
                                        <option value="CNY" data-symbol="¬•" data-country="China" data-flag="üá®üá≥">
                                            CNY - Chinese Yuan (¬•)</option>
                                        <option value="INR" data-symbol="‚Çπ" data-country="India" data-flag="üáÆüá≥">
                                            INR - Indian Rupee (‚Çπ)</option>
                                        <option value="KRW" data-symbol="‚Ç©" data-country="South Korea" data-flag="üá∞üá∑">
                                            KRW - South Korean Won (‚Ç©)</option>
                                        <option value="SGD" data-symbol="S$" data-country="Singapore" data-flag="üá∏üá¨">
                                            SGD - Singapore Dollar (S$)</option>
                                        <option value="HKD" data-symbol="HK$" data-country="Hong Kong" data-flag="üá≠üá∞">
                                            HKD - Hong Kong Dollar (HK$)</option>
                                        <option value="NOK" data-symbol="kr" data-country="Norway" data-flag="üá≥üá¥">
                                            NOK - Norwegian Krone (kr)</option>
                                        <option value="SEK" data-symbol="kr" data-country="Sweden" data-flag="üá∏üá™">
                                            SEK - Swedish Krona (kr)</option>
                                        <option value="DKK" data-symbol="kr" data-country="Denmark" data-flag="üá©üá∞">
                                            DKK - Danish Krone (kr)</option>
                                        <option value="PLN" data-symbol="z≈Ç" data-country="Poland" data-flag="üáµüá±">
                                            PLN - Polish Zloty (z≈Ç)</option>
                                        <option value="CZK" data-symbol="Kƒç" data-country="Czech Republic"
                                            data-flag="üá®üáø"> CZK - Czech Koruna (Kƒç)</option>
                                        <option value="HUF" data-symbol="Ft" data-country="Hungary" data-flag="üá≠üá∫">
                                            HUF - Hungarian Forint (Ft)</option>
                                        <option value="RUB" data-symbol="‚ÇΩ" data-country="Russia" data-flag="üá∑üá∫">
                                            RUB - Russian Ruble (‚ÇΩ)</option>
                                        <option value="BRL" data-symbol="R$" data-country="Brazil" data-flag="üáßüá∑">
                                            BRL - Brazilian Real (R$)</option>
                                        <option value="MXN" data-symbol="$" data-country="Mexico" data-flag="üá≤üáΩ">
                                            MXN - Mexican Peso ($)</option>
                                        <option value="ARS" data-symbol="$" data-country="Argentina" data-flag="üá¶üá∑">
                                            ARS - Argentine Peso ($)</option>
                                        <option value="CLP" data-symbol="$" data-country="Chile" data-flag="üá®üá±">
                                            CLP - Chilean Peso ($)</option>
                                        <option value="COP" data-symbol="$" data-country="Colombia" data-flag="üá®üá¥">
                                            COP - Colombian Peso ($)</option>
                                        <option value="PEN" data-symbol="S/" data-country="Peru" data-flag="üáµüá™">
                                            PEN - Peruvian Sol (S/)</option>
                                        <option value="ZAR" data-symbol="R" data-country="South Africa"
                                            data-flag="üáøüá¶"> ZAR - South African Rand (R)</option>
                                        <option value="EGP" data-symbol="¬£" data-country="Egypt" data-flag="üá™üá¨">
                                            EGP - Egyptian Pound (¬£)</option>
                                        <option value="NGN" data-symbol="‚Ç¶" data-country="Nigeria" data-flag="üá≥üá¨">
                                            NGN - Nigerian Naira (‚Ç¶)</option>
                                        <option value="KES" data-symbol="KSh" data-country="Kenya" data-flag="üá∞üá™">
                                            KES - Kenyan Shilling (KSh)</option>
                                        <option value="MAD" data-symbol="DH" data-country="Morocco" data-flag="üá≤üá¶">
                                            MAD - Moroccan Dirham (DH)</option>
                                        <option value="PKR" data-symbol="‚Ç®" data-country="Pakistan" data-flag="üáµüá∞">
                                            PKR - Pakistani Rupee (‚Ç®)</option>
                                        <option value="BDT" data-symbol="‡ß≥" data-country="Bangladesh" data-flag="üáßüá©">
                                            BDT - Bangladeshi Taka (‡ß≥)</option>
                                        <option value="LKR" data-symbol="Rs" data-country="Sri Lanka" data-flag="üá±üá∞">
                                            LKR - Sri Lankan Rupee (Rs)</option>
                                        <option value="NPR" data-symbol="Rs" data-country="Nepal" data-flag="üá≥üáµ">
                                            NPR - Nepalese Rupee (Rs)</option>
                                        <option value="THB" data-symbol="‡∏ø" data-country="Thailand" data-flag="üáπüá≠">
                                            THB - Thai Baht (‡∏ø)</option>
                                        <option value="VND" data-symbol="‚Ç´" data-country="Vietnam" data-flag="üáªüá≥">
                                            VND - Vietnamese Dong (‚Ç´)</option>
                                        <option value="IDR" data-symbol="Rp" data-country="Indonesia" data-flag="üáÆüá©">
                                            IDR - Indonesian Rupiah (Rp)</option>
                                        <option value="MYR" data-symbol="RM" data-country="Malaysia" data-flag="üá≤üáæ">
                                            MYR - Malaysian Ringgit (RM)</option>
                                        <option value="PHP" data-symbol="‚Ç±" data-country="Philippines" data-flag="üáµüá≠">
                                            PHP - Philippine Peso (‚Ç±)</option>
                                        <option value="TWD" data-symbol="NT$" data-country="Taiwan" data-flag="üáπüáº">
                                            TWD - Taiwan Dollar (NT$)</option>
                                        <option value="NZD" data-symbol="NZ$" data-country="New Zealand"
                                            data-flag="üá≥üáø"> NZD - New Zealand Dollar (NZ$)</option>
                                        <option value="TRY" data-symbol="‚Ç∫" data-country="Turkey" data-flag="üáπüá∑">
                                            TRY - Turkish Lira (‚Ç∫)</option>
                                        <option value="ILS" data-symbol="‚Ç™" data-country="Israel" data-flag="üáÆüá±">
                                            ILS - Israeli Shekel (‚Ç™)</option>
                                        <option value="AED" data-symbol="ÿØ.ÿ•" data-country="UAE" data-flag="üá¶üá™">
                                            AED - UAE Dirham (ÿØ.ÿ•)</option>
                                        <option value="SAR" data-symbol="ÿ±.ÿ≥" data-country="Saudi Arabia"
                                            data-flag="üá∏üá¶"> SAR - Saudi Riyal (ÿ±.ÿ≥)</option>
                                        <option value="QAR" data-symbol="ÿ±.ŸÇ" data-country="Qatar" data-flag="üá∂üá¶">
                                            QAR - Qatari Riyal (ÿ±.ŸÇ)</option>
                                        <option value="KWD" data-symbol="ÿØ.ŸÉ" data-country="Kuwait" data-flag="üá∞üáº">
                                            KWD - Kuwaiti Dinar (ÿØ.ŸÉ)</option>
                                        <option value="BHD" data-symbol="ÿØ.ÿ®" data-country="Bahrain" data-flag="üáßüá≠">
                                            BHD - Bahraini Dinar (ÿØ.ÿ®)</option>
                                        <option value="OMR" data-symbol="ÿ±.ÿπ." data-country="Oman" data-flag="üá¥üá≤">
                                            OMR - Omani Rial (ÿ±.ÿπ.)</option>
                                        <option value="JOD" data-symbol="ÿØ.ÿß" data-country="Jordan" data-flag="üáØüá¥">
                                            JOD - Jordanian Dinar (ÿØ.ÿß)</option>
                                        <option value="LBP" data-symbol="ŸÑ.ŸÑ" data-country="Lebanon" data-flag="üá±üáß">
                                            LBP - Lebanese Pound (ŸÑ.ŸÑ)</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-money-bill-wave text-success me-2"></i>
                                        Monthly Income (<span id="incomeSymbol" class="currency-display">$</span>)
                                    </label>
                                    <input type="number" class="form-control" id="income" placeholder="e.g., 3000"
                                        required min="0" step="0.01">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-home text-primary me-2"></i>
                                        Rent/Housing (<span id="rentSymbol" class="currency-display">$</span>)
                                    </label>
                                    <input type="number" class="form-control" id="rent" placeholder="e.g., 1200"
                                        required min="0" step="0.01">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-utensils text-warning me-2"></i>
                                        Food & Groceries (<span id="foodSymbol" class="currency-display">$</span>)
                                    </label>
                                    <input type="number" class="form-control" id="food" placeholder="e.g., 400" required
                                        min="0" step="0.01">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-gamepad text-info me-2"></i>
                                        Entertainment (<span id="entertainmentSymbol" class="currency-display">$</span>)
                                    </label>
                                    <input type="number" class="form-control" id="entertainment" placeholder="e.g., 200"
                                        required min="0" step="0.01">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-graduation-cap text-danger me-2"></i>
                                        Education (<span id="educationSymbol" class="currency-display">$</span>)
                                    </label>
                                    <input type="number" class="form-control" id="education" placeholder="e.g., 300"
                                        required min="0" step="0.01">
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label fw-semibold">
                                        <i class="fas fa-plus-circle text-secondary me-2"></i>
                                        Other Expenses (<span id="otherSymbol" class="currency-display">$</span>)
                                    </label>
                                    <input type="number" class="form-control" id="other" placeholder="e.g., 150"
                                        required min="0" step="0.01">
                                </div>
                            </div>

                            <div class="text-center mt-4">
                                <button type="submit" class="btn btn-ai btn-lg">
                                    <span class="loading-spinner spinner-border spinner-border-sm me-2"></span>
                                    <i class="fas fa-magic me-2"></i>
                                    Generate AI Saving Plan
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="resultsSection">
            <!-- Statistics Cards -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <div class="stat-card income">
                        <i class="fas fa-arrow-up fa-2x mb-2"></i>
                        <h4 id="totalIncome">$0</h4>
                        <p class="mb-0">Monthly Income</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card expenses">
                        <i class="fas fa-arrow-down fa-2x mb-2"></i>
                        <h4 id="totalExpenses">$0</h4>
                        <p class="mb-0">Total Expenses</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="stat-card savings">
                        <i class="fas fa-piggy-bank fa-2x mb-2"></i>
                        <h4 id="totalSavings">$0</h4>
                        <p class="mb-0">Available Savings</p>
                    </div>
                </div>
            </div>

            <!-- AI Suggestions -->
            <div class="row mb-4">
                <div class="col-12">
                    <div class="ai-suggestion" id="aiSuggestion">
                        <h4><i class="fas fa-robot me-2"></i>AI Budget Analysis</h4>
                        <p id="budgetAnalysis" class="mb-0"></p>
                    </div>
                </div>
            </div>

            <!-- Chart and Advice -->
            <div class="row">
                <div class="col-lg-6 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title text-center mb-3">
                                <i class="fas fa-chart-pie me-2 text-primary"></i>
                                Budget Breakdown
                            </h5>
                            <div class="chart-container">
                                <canvas id="budgetChart"></canvas>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-lg-6">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title mb-3">
                                <i class="fas fa-lightbulb me-2 text-warning"></i>
                                AI Saving Tips
                            </h5>
                            <div id="savingTips"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer class="text-center py-4 mt-5">
        <div class="container">
            <p class="text-muted mb-0">
                <i class="fas fa-heart text-danger me-1"></i>
                AI Saving Maker - Smart Financial Planning
            </p>
        </div>
    </footer>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script>
        let budgetChart = null;
        let selectedCurrency = 'USD';
        let currencySymbol = '$';
        let currencyFlag = 'üá∫üá∏';
        let countryName = 'United States';

        // Enhanced AI Budget Analyzer with more detailed tips
        class AIBudgetAnalyzer {
            constructor() {
                this.idealRatios = {
                    housing: 0.30,
                    food: 0.15,
                    entertainment: 0.10,
                    education: 0.08,
                    other: 0.12,
                    savings: 0.25
                };

                // Country-specific financial tips
                this.countryTips = {
                    'Pakistan': {
                        savings: 'Consider investing in National Savings Schemes or mutual funds for better returns',
                        housing: 'Joint family living can reduce housing costs significantly',
                        food: 'Buy from wholesale markets like Sabzi Mandi for cheaper groceries',
                        education: 'Look for scholarship opportunities and government education schemes'
                    },
                    'India': {
                        savings: 'Utilize PPF, ELSS, and SIP investments for tax benefits',
                        housing: 'Consider tier-2 cities for affordable housing options',
                        food: 'Cook at home and buy from local markets to save 40-50%',
                        education: 'Online courses are much cheaper than traditional education'
                    },
                    'United States': {
                        savings: 'Maximize 401k matching and consider Roth IRA',
                        housing: 'Consider house hacking or finding roommates',
                        food: 'Use coupons and shop at discount stores like Aldi',
                        education: 'Community college for first 2 years can save thousands'
                    }
                };
            }

            analyzeSpending(income, expenses, country) {
                const totalExpenses = Object.values(expenses).reduce((sum, exp) => sum + exp, 0);
                const ratios = {};

                Object.keys(expenses).forEach(key => {
                    ratios[key] = expenses[key] / income;
                });

                const totalExpenseRatio = totalExpenses / income;
                const savingsRatio = Math.max(0, (income - totalExpenses) / income);

                return {
                    ratios,
                    totalExpenseRatio,
                    savingsRatio,
                    overspending: this.detectOverspending(ratios, country),
                    riskLevel: this.calculateRiskLevel(totalExpenseRatio, savingsRatio),
                    countrySpecific: this.getCountrySpecificAdvice(country, ratios, income)
                };
            }

            detectOverspending(ratios, country) {
                const issues = [];

                if (ratios.rent > this.idealRatios.housing) {
                    const overspend = ((ratios.rent - this.idealRatios.housing) * 100).toFixed(1);
                    issues.push({
                        category: 'Housing',
                        severity: 'high',
                        overspend: overspend,
                        message: `Housing costs are ${overspend}% above recommended 30% of income. ${this.getCountryTip(country, 'housing')}`,
                        icon: 'fas fa-home'
                    });
                }

                if (ratios.food > this.idealRatios.food) {
                    const overspend = ((ratios.food - this.idealRatios.food) * 100).toFixed(1);
                    issues.push({
                        category: 'Food',
                        severity: 'medium',
                        overspend: overspend,
                        message: `Food expenses are ${overspend}% above recommended 15%. ${this.getCountryTip(country, 'food')}`,
                        icon: 'fas fa-utensils'
                    });
                }

                if (ratios.entertainment > this.idealRatios.entertainment) {
                    const overspend = ((ratios.entertainment - this.idealRatios.entertainment) * 100).toFixed(1);
                    issues.push({
                        category: 'Entertainment',
                        severity: 'low',
                        overspend: overspend,
                        message: `Entertainment spending is ${overspend}% above recommended 10%. Find free local activities or group discounts.`,
                        icon: 'fas fa-gamepad'
                    });
                }

                if (ratios.education > this.idealRatios.education) {
                    const overspend = ((ratios.education - this.idealRatios.education) * 100).toFixed(1);
                    issues.push({
                        category: 'Education',
                        severity: 'medium',
                        overspend: overspend,
                        message: `Education costs are ${overspend}% above recommended 8%. ${this.getCountryTip(country, 'education')}`,
                        icon: 'fas fa-graduation-cap'
                    });
                }

                return issues;
            }

            getCountryTip(country, category) {
                if (this.countryTips[country] && this.countryTips[country][category]) {
                    return this.countryTips[country][category];
                }
                return this.getGenericTip(category);
            }

            getGenericTip(category) {
                const genericTips = {
                    housing: 'Consider sharing accommodation or moving to a less expensive area',
                    food: 'Plan meals, buy in bulk, and cook at home more often',
                    entertainment: 'Look for free events, use student discounts, or find group deals',
                    education: 'Explore online courses, scholarships, and used textbooks'
                };
                return genericTips[category] || 'Consider reducing expenses in this category';
            }

            calculateRiskLevel(expenseRatio, savingsRatio) {
                if (expenseRatio >= 0.95) return 'critical';
                if (expenseRatio >= 0.85) return 'high';
                if (expenseRatio >= 0.75) return 'medium';
                return 'low';
            }

            getCountrySpecificAdvice(country, ratios, income) {
                const advice = [];

                if (this.countryTips[country]) {
                    if (ratios.savings < 0.20) {
                        advice.push({
                            type: 'savings',
                            message: this.countryTips[country].savings,
                            priority: 'high'
                        });
                    }
                }

                // Income-based advice
                if (income < 2000) {
                    advice.push({
                        type: 'income',
                        message: 'Consider freelancing, part-time work, or skill development to increase income',
                        priority: 'high'
                    });
                } else if (income > 5000) {
                    advice.push({
                        type: 'investment',
                        message: 'With higher income, consider diversifying into investments and retirement planning',
                        priority: 'medium'
                    });
                }

                return advice;
            }

            generateBudgetAnalysis(income, expenses, country) {
                const analysis = this.analyzeSpending(income, expenses, country);
                const totalExpenses = Object.values(expenses).reduce((sum, exp) => sum + exp, 0);
                const savings = income - totalExpenses;
                const savingsPercentage = (savings / income * 100).toFixed(1);

                let message = `Based on your ${currencyFlag} ${currencySymbol}${income.toLocaleString()} monthly income from ${country}, `;

                if (analysis.riskLevel === 'critical') {
                    message += `üö® CRITICAL: You're spending ${(analysis.totalExpenseRatio * 100).toFixed(1)}% of your income! This is unsustainable and requires immediate action.`;
                } else if (analysis.riskLevel === 'high') {
                    message += `‚ö†Ô∏è HIGH RISK: You're spending ${(analysis.totalExpenseRatio * 100).toFixed(1)}% of your income. You need to cut expenses urgently.`;
                } else if (analysis.riskLevel === 'medium') {
                    message += `‚ö° MODERATE RISK: You're spending ${(analysis.totalExpenseRatio * 100).toFixed(1)}% of your income. There's room for improvement.`;
                } else {
                    message += `‚úÖ GOOD FINANCIAL HEALTH: You're spending ${(analysis.totalExpenseRatio * 100).toFixed(1)}% of your income and saving ${savingsPercentage}%!`;
                }

                if (savings > 0) {
                    message += ` You can save ${currencySymbol}${savings.toLocaleString()} (${savingsPercentage}%) monthly.`;
                } else {
                    message += ` You're overspending by ${currencySymbol}${Math.abs(savings).toLocaleString()}!`;
                }

                return {
                    message,
                    analysis,
                    recommendations: this.generateRecommendations(analysis, income, expenses, country)
                };
            }

            generateRecommendations(analysis, income, expenses, country) {
                const recommendations = [];

                // Priority recommendations based on overspending
                if (analysis.overspending.length > 0) {
                    analysis.overspending.forEach(issue => {
                        recommendations.push({
                            category: issue.category,
                            severity: issue.severity,
                            message: issue.message,
                            icon: issue.icon,
                            savings: (income * parseFloat(issue.overspend) / 100).toFixed(0)
                        });
                    });
                }

                // General recommendations
                if (analysis.savingsRatio < 0.20) {
                    recommendations.push({
                        category: 'Emergency Fund',
                        severity: 'high',
                        message: 'Build an emergency fund of 3-6 months expenses. Start with just $50/month.',
                        icon: 'fas fa-shield-alt',
                        savings: Math.max(50, income * 0.1).toFixed(0)
                    });
                }

                // Country-specific recommendations
                if (analysis.countrySpecific.length > 0) {
                    analysis.countrySpecific.forEach(advice => {
                        recommendations.push({
                            category: advice.type,
                            severity: advice.priority,
                            message: advice.message,
                            icon: 'fas fa-globe',
                            savings: '0'
                        });
                    });
                }

                // Income optimization recommendations
                if (income < 3000) {
                    recommendations.push({
                        category: 'Income Growth',
                        severity: 'medium',
                        message: 'Consider developing high-demand skills like coding, digital marketing, or data analysis for better income.',
                        icon: 'fas fa-chart-line',
                        savings: '0'
                    });
                }

                return recommendations.slice(0, 6); // Limit to top 6 recommendations
            }
        }

        // Initialize AI Analyzer
        const aiAnalyzer = new AIBudgetAnalyzer();

        // Currency change handler
        document.getElementById('currency').addEventListener('change', function () {
            const selectedOption = this.options[this.selectedIndex];
            if (selectedOption.value) {
                selectedCurrency = selectedOption.value;
                currencySymbol = selectedOption.dataset.symbol;
                currencyFlag = selectedOption.dataset.flag;
                countryName = selectedOption.dataset.country;

                // Update all currency symbols
                document.querySelectorAll('[id$="Symbol"]').forEach(el => {
                    el.textContent = currencySymbol;
                });
            }
        });

        // Form submission handler
        document.getElementById('budgetForm').addEventListener('submit', function (e) {
            e.preventDefault();

            const submitBtn = this.querySelector('button[type="submit"]');
            const spinner = submitBtn.querySelector('.loading-spinner');

            // Show loading state
            spinner.style.display = 'inline-block';
            submitBtn.disabled = true;

            // Get form data
            const formData = {
                income: parseFloat(document.getElementById('income').value),
                rent: parseFloat(document.getElementById('rent').value),
                food: parseFloat(document.getElementById('food').value),
                entertainment: parseFloat(document.getElementById('entertainment').value),
                education: parseFloat(document.getElementById('education').value),
                other: parseFloat(document.getElementById('other').value)
            };

            // Simulate AI processing delay
            setTimeout(() => {
                generateBudgetAnalysis(formData);

                // Hide loading state
                spinner.style.display = 'none';
                submitBtn.disabled = false;

                // Show results
                document.getElementById('resultsSection').style.display = 'block';
                document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
            }, 2000);
        });

        function generateBudgetAnalysis(data) {
            const expenses = {
                rent: data.rent,
                food: data.food,
                entertainment: data.entertainment,
                education: data.education,
                other: data.other
            };

            const totalExpenses = Object.values(expenses).reduce((sum, exp) => sum + exp, 0);
            const savings = data.income - totalExpenses;

            // Update statistics
            document.getElementById('totalIncome').textContent = `${currencySymbol}${data.income.toLocaleString()}`;
            document.getElementById('totalExpenses').textContent = `${currencySymbol}${totalExpenses.toLocaleString()}`;
            document.getElementById('totalSavings').textContent = `${currencySymbol}${savings.toLocaleString()}`;

            // Generate AI analysis
            const aiResult = aiAnalyzer.generateBudgetAnalysis(data.income, expenses, countryName);
            document.getElementById('budgetAnalysis').innerHTML = aiResult.message;

            // Create chart
            createBudgetChart(expenses, savings);

            // Generate saving tips
            generateSavingTips(aiResult.recommendations);
        }

        function createBudgetChart(expenses, savings) {
            const ctx = document.getElementById('budgetChart').getContext('2d');

            if (budgetChart) {
                budgetChart.destroy();
            }

            const chartData = [];
            const chartLabels = [];
            const chartColors = [];

            // Add expenses
            Object.entries(expenses).forEach(([key, value]) => {
                if (value > 0) {
                    chartData.push(value);
                    chartLabels.push(key.charAt(0).toUpperCase() + key.slice(1));

                    const colors = {
                        rent: '#FF6384',
                        food: '#36A2EB',
                        entertainment: '#FFCE56',
                        education: '#4BC0C0',
                        other: '#9966FF'
                    };
                    chartColors.push(colors[key] || '#FF9F40');
                }
            });

            // Add savings if positive
            if (savings > 0) {
                chartData.push(savings);
                chartLabels.push('Savings');
                chartColors.push('#4CAF50');
            }

            budgetChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: chartLabels,
                    datasets: [{
                        data: chartData,
                        backgroundColor: chartColors,
                        borderWidth: 2,
                        borderColor: '#fff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function (context) {
                                    const label = context.label || '';
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = ((value / total) * 100).toFixed(1);
                                    return `${label}: ${currencySymbol}${value.toLocaleString()} (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function generateSavingTips(recommendations) {
            const tipsContainer = document.getElementById('savingTips');

            if (recommendations.length === 0) {
                tipsContainer.innerHTML = `
                    <div class="advice-card success card p-3">
                        <h6><i class="fas fa-check-circle me-2"></i>Excellent Budget Management!</h6>
                        <p class="mb-0">Your spending is well-balanced. Keep up the good work and consider investing your savings for long-term growth.</p>
                    </div>
                `;
                return;
            }

            let tipsHTML = '';
            recommendations.forEach((tip, index) => {
                const severityClass = tip.severity === 'high' ? 'danger' :
                    tip.severity === 'medium' ? 'warning' : 'success';

                const savingsText = tip.savings && tip.savings !== '0' ?
                    `<small class="text-muted"><i class="fas fa-piggy-bank me-1"></i>Potential monthly savings: ${currencySymbol}${tip.savings}</small>` : '';

                tipsHTML += `
                    <div class="advice-card ${severityClass} card p-3 mb-3">
                        <h6><i class="${tip.icon} me-2"></i>${tip.category}</h6>
                        <p class="mb-1">${tip.message}</p>
                        ${savingsText}
                    </div>
                `;
            });

            tipsContainer.innerHTML = tipsHTML;
        }

        // Initialize form with default currency
        document.addEventListener('DOMContentLoaded', function () {
            // Set default currency symbols
            document.querySelectorAll('[id$="Symbol"]').forEach(el => {
                el.textContent = currencySymbol;
            });
        });
    </script>
</body>

</html>